Redis評価について（テスト②時点）

Redis設定：

Redisのメモリ関係の設定は以下の通り。

・コンテナのメモリサイズ：指定なし
・Redis設定：
	maxmemory 1GB
	maxmemory-policy volatile-ttl
	maxclients 1000

基本的にRedisが使用するメモリの大部分はデータ格納領域のため、コンテナのメモリ使用量は「maxmemory＋α」と想定。

本件のRedisに格納するデータは、セッションデータのみ。
セッションデータは、セッションがtimeoutするまで保持されるので、利用者数に比例したメモリを消費する。
なお、万が一、メモリ不足が発生した場合は、セッションデータであることから古いデータから削除する設定としている。


テスト環境での評価：

現状のテスト環境のメモリ使用状況については「redis.xlsx」参照のこと。

このファイルより、テスト①環境では最大メモリ使用量：36MB程度となっている。
必要なメモリ容量は、アプリによって異なるので、
本番移行後のアプリの利用状況に即した利用状況に等しければ正確な値となるが、現状では困難。

ここでは暫定的にテスタ人数で計算すると、現状テスタ人数を30程度とするならば1MB/人程度か？
よって、現状の設定値で1000人程度が最大利用者数となるため、現状の設定値で大丈夫となるが、根拠が薄いので要検討事項。

接続数については、テスト①環境で、ほぼtomcatインスタンス数と同数なので、現状の値で余裕がある。


今後、負荷試験やSTなどで、業務の内容や利用者数の増加により、maxmemoryの値を調整する必要がある。
特に、使用中にセッションが切れるなどの現象が発生する場合は、Redisのメモリを増やすことを検討すること。


以上
